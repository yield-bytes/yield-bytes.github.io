<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yield-bytes.gitee.io","root":"/blog/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","Pisces | Gemini":240,"width":300,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="&amp;#8195;&amp;#8195;在前面的文章中，详细给出了HBase HA高可用部署以及测试的内容，本篇文章将对HBase架构进行分析。 1、有关HBase基本介绍1.1 HBase解决的痛点： 解决随机近实时的高效的读写 解决非结构化的数据存储  1.2 HBase应用： 可以存储非结构化的数据 被用来做实时数据分析(整合flume、storm、streaming等) 引用HBase作为业务存储，则">
<meta property="og:type" content="article">
<meta property="og:title" content="HBase架构分析">
<meta property="og:url" content="https://yield-bytes.gitee.io/blog/2019/11/02/HBase%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="yield-bytes">
<meta property="og:description" content="&amp;#8195;&amp;#8195;在前面的文章中，详细给出了HBase HA高可用部署以及测试的内容，本篇文章将对HBase架构进行分析。 1、有关HBase基本介绍1.1 HBase解决的痛点： 解决随机近实时的高效的读写 解决非结构化的数据存储  1.2 HBase应用： 可以存储非结构化的数据 被用来做实时数据分析(整合flume、storm、streaming等) 引用HBase作为业务存储，则">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191027170545189.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191027173035586.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191027173150411.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191028225523874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191028232225435.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2019102900132276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191029213447409.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20191029225007131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2019-11-02T01:37:41.000Z">
<meta property="article:modified_time" content="2020-02-03T09:50:58.000Z">
<meta property="article:tag" content="HBase">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20191027170545189.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70">

<link rel="canonical" href="https://yield-bytes.gitee.io/blog/2019/11/02/HBase%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>HBase架构分析 | yield-bytes</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/blog/atom.xml" title="yield-bytes" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">yield-bytes</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">分享与沉淀</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th-large fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://gitee.com/yield-bytes" class="github-corner" title="Follow me on Gitee" aria-label="Follow me on Gitee" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yield-bytes.gitee.io/blog/2019/11/02/HBase%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://www.linuxprobe.com/wp-content/uploads/2018/06/QQ%E5%9B%BE%E7%89%8720180625205006.png">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="一个非常专注技术总结与分享的博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yield-bytes">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HBase架构分析
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-02 09:37:41" itemprop="dateCreated datePublished" datetime="2019-11-02T09:37:41+08:00">2019-11-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-03 17:50:58" itemprop="dateModified" datetime="2020-02-03T17:50:58+08:00">2020-02-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/HBase/" itemprop="url" rel="index"><span itemprop="name">HBase</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>9.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>&#8195;&#8195;在前面的<a target="_blank" rel="noopener" href="https://blog.csdn.net/pysense/article/details/102635656">文章</a>中，详细给出了HBase HA高可用部署以及测试的内容，本篇文章将对HBase架构进行分析。</p>
<h3 id="1、有关HBase基本介绍"><a href="#1、有关HBase基本介绍" class="headerlink" title="1、有关HBase基本介绍"></a>1、有关HBase基本介绍</h3><h4 id="1-1-HBase解决的痛点："><a href="#1-1-HBase解决的痛点：" class="headerlink" title="1.1 HBase解决的痛点："></a>1.1 HBase解决的痛点：</h4><ul>
<li>解决随机近实时的高效的读写</li>
<li>解决非结构化的数据存储</li>
</ul>
<h4 id="1-2-HBase应用："><a href="#1-2-HBase应用：" class="headerlink" title="1.2 HBase应用："></a>1.2 HBase应用：</h4><ul>
<li>可以存储非结构化的数据</li>
<li>被用来做实时数据分析(整合flume、storm、streaming等)<blockquote>
<p>引用HBase作为业务存储，则需要注意的点（按官方指引的翻译）：<br>首先确保使用场景有足够多的数据，上亿或者十几亿行的数据，HBase将非常适合<br>第二，确保业务需求中不需要用到关系型数据库那种严格的索引、事务、高级查询等<br>第三点，确保足够多的硬件服务器，至少5台个HDFS节点以上，以便发挥HDFS性能。</p>
</blockquote>
</li>
</ul>
<h4 id="1-3-Hbase特性："><a href="#1-3-Hbase特性：" class="headerlink" title="1.3 Hbase特性："></a>1.3 Hbase特性：</h4><ul>
<li><p>Hadoop的分布式、开源的、多版本的非关系型数据库</p>
</li>
<li><p>Hbase存储Key-Value格式，面向列存储，Hbase底层为byte[]比特数组数据，不存在数据类型一说。</p>
</li>
<li><p>严格一致的读写</p>
</li>
<li><p>表的自动和可配置分片</p>
</li>
<li><p>RegionServer之间的自动故障转移支持</p>
</li>
<li><p>方便的基类，用于通过Apache HBase表备份Hadoop MapReduce作业</p>
</li>
<li><p>块缓存和布隆过滤器用于实时查询</p>
</li>
</ul>
<h3 id="2、HBase架构"><a href="#2、HBase架构" class="headerlink" title="2、HBase架构"></a>2、HBase架构</h3><p><img src="https://img-blog.csdnimg.cn/20191027170545189.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">如上图所示，架构主要有以下4个部分</p>
<a id="more"></a>

<h4 id="2-1-HMaster"><a href="#2-1-HMaster" class="headerlink" title="2.1 HMaster"></a>2.1 HMaster</h4><ul>
<li>负责管理HBase的元数据，表结构，表的Region信息</li>
<li>负责表的创建，删除和修改</li>
<li>负责为HRegionServer分配Region，分配后将元数据写入相应位置</li>
</ul>
<h4 id="2-1-HRegionServer"><a href="#2-1-HRegionServer" class="headerlink" title="2.1 HRegionServer"></a>2.1 HRegionServer</h4><ul>
<li>存储多个HRegion</li>
<li>处理Client端的读写请求（根据从HMaster返回的元数据找到对应的HRegionServer）</li>
<li>管理Region的Split分裂、StoreFile的Compaction合并。</li>
<li>一个RegionServer管理着多个Region，在HBase运行期间，可以动态添加、删除HRegionServer。</li>
</ul>
<h4 id="2-3-HRegion"><a href="#2-3-HRegion" class="headerlink" title="2.3 HRegion"></a>2.3 HRegion</h4><ul>
<li>一个HRegion里可能有1个或多个Store（参考上图）。</li>
<li>HRegionServer维护一个HLog。</li>
<li>HRegion是HBase分布式存储和负载的最小单元，但不是HBase数据存储到文件的最小单元。</li>
<li>表通常被保存在多个HRegionServer的多个Region中。</li>
</ul>
<h4 id="2-4-Store"><a href="#2-4-Store" class="headerlink" title="2.4 Store"></a>2.4 Store</h4><ul>
<li><p>Store由内存中的MemStore和磁盘中的若干StoreFile组成（参考上图）</p>
</li>
<li><p>一个Store里有1个或多个StoreFile和一个memStore。</p>
</li>
<li><p>每个Store存储一个列族。</p>
<h4 id="2-5-MemStore、StoreFile、HFile"><a href="#2-5-MemStore、StoreFile、HFile" class="headerlink" title="2.5 MemStore、StoreFile、HFile"></a>2.5 MemStore、StoreFile、HFile</h4></li>
<li><p>MemStore：<br>首先，memStore 是在内存中存在，保存修改key-value数据；当memStore的大小达到一个阀值（默认64MB）时，memStore会被flush到文件，也就是存在磁盘上。</p>
</li>
<li><p>StoreFile：<br>接上面内容，memStore的每次flush操作都会生成一个新的StoreFile，StoreFile底层是以HFile的格式保存，当有多个StoreFile后，将会触发为合并为一个大的StoreFile。</p>
</li>
<li><p>HFile：<br>HFile是HBase中KeyValue数据的存储格式，在hdfs上是二进制格式文件，一个StoreFile对应着一个HFile。HFile有自己的数据结构。<br>HFile写入的时候，分一个块一个块的写入，每个Block块64KB，这样有利于数据的随机访问，不利于连续访问，若连续访问需求大，可将Block块设为较大值。<br>HFile物理文件形式参考下面4.3内容</p>
</li>
</ul>
<h4 id="2-6-WALs——Write-Ahead-Log预写日志（HLog）"><a href="#2-6-WALs——Write-Ahead-Log预写日志（HLog）" class="headerlink" title="2.6 WALs——Write-Ahead-Log预写日志（HLog）"></a>2.6 WALs——Write-Ahead-Log预写日志（HLog）</h4><p>&#8195;&#8195;数据库在事务机制中常见的一致性的实现方式就是通过记录日志，通过日志文件的方式实现写入一致性、数据恢复或者数据备份，那么对于HBases也有同样的逻辑，因为大型分布式系统中硬件故障很常见，如果MemStore还没有及时flush到HFile，服务器宕机或者断电，那么MemStore部分的数据肯会丢失。<br>&#8195;&#8195;HBase给出的解决方案：先写入MemStore中，然后更新hlog中，只有成功更新到hlog之后，写操作才能被认为是成功完成。如果在MemStore没有写到hlog之前宕机，HBase重启后可以从hlog恢复。Hbase集群中每台服务器维护一个hlog文件。</p>
<p>==<strong>hlog过期</strong>==<br>&#8195;&#8195;当数据从memstore写入到磁盘中，Hlog就已经没有用了，会把/hbase/WALs目录下的数据移动到/hbase/oldWALs 目录下，oldWALs目录下的数据会根据 hbase.master.cleaner.interval (默认1分钟)配置的时间定期去检查，如发现有数据会清除，清除前还会检验一个参数 hbase.master.logcleaner.ttl ，也就是说数据保存1分钟以上才会删除，如果一分钟内数据直接从memstore写入到了磁盘，oldWALs下的数据也不会被删除</p>
<h4 id="2-7-zookeeper"><a href="#2-7-zookeeper" class="headerlink" title="2.7 zookeeper"></a>2.7 zookeeper</h4><ul>
<li>通过选举（抢占zk临时节点），保证任何时候，集群中只有一个master，Master与RegionServers 启动时会向ZooKeeper注册</li>
<li>RegionServer 向zookeeper的临时znode注册，提供RegionsSrver状态信息（是否在线）。</li>
<li>存放所有Region的寻址入口</li>
<li>存储HBase的schema和table元数据</li>
<li>HMaster启动时候会将hbase系统表-ROOT- 加载到 zookeeper cluster，通过zookeeper cluster可以获取当前系统表元信息的存储所对应的RegionServer信息。</li>
</ul>
<h3 id="3、数据模型"><a href="#3、数据模型" class="headerlink" title="3、数据模型"></a>3、数据模型</h3><p>&#8195;&#8195;这里以Amandeep Khurana的<a target="_blank" rel="noopener" href="http://0b4af6cdc2f0c5998459-c0245c5c937c5dedcca3f1764ecc9b2f.r43.cf2.rackcdn.com/9353-login1210_khurana.pdf">《Introduction to HBase Schema Design》</a>作为参考<br>&#8195;&#8195;HBase的表结构如下图3所示：<br><img src="https://img-blog.csdnimg.cn/20191027173035586.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">&#8195;&#8195;该表有两个列簇： Personal and Office，每个列簇有两个列，例如Personal：姓名和家庭电话，每个小格子cells用来存储真正数据，例如John及其电话，但Row Key 不属于cell。</p>
<p>&#8195;&#8195;HBase行记录的数据结构，其实就是一个嵌套map（嵌套字典），HBase用这种方式组织了数据，以上图的第一行John为例，该0001行字典如下：<br><img src="https://img-blog.csdnimg.cn/20191027173150411.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">&#8195;&#8195;因为大家更熟悉hash map或字典结构，从上图可以看到，HBase的数据单元cell，通过把timestamp作为最里层字典的key，从而数据多版本的控制。看到该map结构，大家可以联想到mangodb，这伙计大有赶超hadoop之势，同样具备分布式大数据的存储、查询能力，它也用这种结构来存储数据，只不过mangodb用的粒度更小是json结构。</p>
<h3 id="4、表结构组成（对应图3）"><a href="#4、表结构组成（对应图3）" class="headerlink" title="4、表结构组成（对应图3）"></a>4、表结构组成（对应图3）</h3><p>Table（表格）<br>一个HBase表格由多行组成。</p>
<p>Row（行）<br>&#8195;&#8195;RowKey没有特定的数据类型，都是字节数组类型，任何字符串都可以作为行键表的中行数据按照Rowkey的字节（byte order) 排序存储HBase中的行里面包含一个key和一个或者多个包含值的列。行按照行的key字母顺序存储在表格中。因为这个原因，行的key的设计就显得非常重要。数据的存储设计目的是让数据类型相近的数据存储到一起。</p>
<p>Column Family（列族）<br>&#8195;&#8195;因为性能的原因，列族物理上包含一组列和它们的值。每一个列族拥有一系列的存储属性，例如值是否缓存在内存中，数据是否要压缩或者他的行key是否要加密等等。表格中的每一行拥有相同的列族，尽管一个给定的行可能没有存储任何数据在一个给定的列族中。</p>
<p>Column Qualifier（列名）<br>&#8195;&#8195;列族必须定义表时给出，每个列族可以有一个或多个列成员（Column Qualigier)，列成员不需要在定义表时给出，新的列族成员（name、phone）可以随后按需动态加入。列族Personal在创建表格时已被确定，但是列名则可以以后业务需要时动态追加，例如给Personal增加一个列名:company字段，用于存储个人的公司信息</p>
<p>Cell（单元）</p>
<p>&#8195;&#8195;单元是由行、列族、列限定符、值和代表值版本的时间戳组成的。Cell由RowKey，列族：列名（Column Qualifier），时间戳唯一决定。Cell中的数据是没有类型的，全部以字节码形式存储。每个单元格保存着同一份数据的多个版本<br>，不同时间版本的数据按照时间顺序倒序排序。</p>
<p>Timestamp（时间戳）<br> &#8195;&#8195;每个Cell可能有多个版本，它们之间用时间戳区分。</p>
<h3 id="5、HBase物理文件存储过程"><a href="#5、HBase物理文件存储过程" class="headerlink" title="5、HBase物理文件存储过程"></a>5、HBase物理文件存储过程</h3><h4 id="5-1-HRegion在表的上位置"><a href="#5-1-HRegion在表的上位置" class="headerlink" title="5.1 HRegion在表的上位置"></a>5.1 HRegion在表的上位置</h4><p>&#8195;&#8195;HBase的一个典型Big Table 在行的方向上水平分割为多个HRegion，所有行都按照row key的字典序排列。（注意如果Table表刚建初期，数据量不多，此时Table仅有一个HRegion）<br><img src="https://img-blog.csdnimg.cn/20191028225523874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="4-2-HRegion自动拆分"><a href="#4-2-HRegion自动拆分" class="headerlink" title="4.2 HRegion自动拆分"></a>4.2 HRegion自动拆分</h4><p>&#8195;&#8195;HRegion按照大小拆分，每个Table初始只有一个HRegion，随着数据不断插入表，Rowkey越来越多，HRegion不断增大，当增大到一个阀值（默认256M）的时候，HRegion会被拆分为两个新的HRegion，如下图所示，所以当Table中的行不断增多，就会有越有更多HRegion，这些HRegion分布式存在多台HRegion Server上，只要有足够的节点服务器，那么HBase就可以继续被扩容，存下百亿行都OK。在传统关系型数据库中，这种体量的行数，很难想象！<br><img src="https://img-blog.csdnimg.cn/20191028232225435.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="4-3-HRegion-分布式存储"><a href="#4-3-HRegion-分布式存储" class="headerlink" title="4.3 HRegion 分布式存储"></a>4.3 HRegion 分布式存储</h4><p>&#8195;&#8195;HRegion是Hbase中分布式存储和负载均衡的最小单元，同一个table的不同HRegion可以分布式存储在不同的HRegion Server上，这里说的“负载均衡”是指：例如下图，如果table的所有HRegion都扔到一台服务器上存储，容易出现不平衡分布（数据倾斜），因此需要考虑所有的Region平衡分布到每个节点上，如下图所示，但一个HRegion是不会拆分到多个节点上，因为HRegion是HMaster分布式存储可以管理的最小单元。（机灵的同学此时会想到：同一个HRegion需要拷贝三份或多份再存到不同节点上吗？注意：这里完全不需要，因为HRegion最终存放是在HDFS上的一个二进制文件block，hdfs本身就会将这个block自动拷贝多份，再存到其他节点。）<br><img src="https://img-blog.csdnimg.cn/2019102900132276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="5-2-Hbase数据在HDFS的存储"><a href="#5-2-Hbase数据在HDFS的存储" class="headerlink" title="5.2 Hbase数据在HDFS的存储"></a>5.2 Hbase数据在HDFS的存储</h4><p>&#8195;&#8195;HRegion虽然是分布式存储的最小单元，但并不是存储的最小单元。HRegion由一个或者多个Store组成，每个Store保存一个Columns Family。每个Store又由一个memStore和0至多个StoreFile组成。StoreFile最终以HFile格式保存在HDFS上<br><img src="https://img-blog.csdnimg.cn/20191029213447409.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">&#8195;&#8195;对于company表，上面提到每个Store保存一个Columns Family，那么在HDFS上是怎样的文件呢？通过查看HBase在hdfs文件系统创建的data目录如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@dn2 ~]# hdfs dfs -ls /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/</span><br><span class="line">Found 4 items</span><br><span class="line">-rw-r--r--   3 root supergroup         42 ** /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/.regioninfo</span><br><span class="line">drwxr-xr-x   - root supergroup          0 ** /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/depart_info</span><br><span class="line">drwxr-xr-x   - root supergroup          0 ** /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/recovered.edits</span><br><span class="line">drwxr-xr-x   - root supergroup          0 ** /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/staff_info</span><br></pre></td></tr></table></figure>
<p>&#8195;&#8195;Hbase的数据在HDFS中的路径结构如下：<br>==hdfs://dn2:9000/hbase/data/{名字空间}/{表名}/{区域名称}/{列族名称}/{文件名}==<br>具体说明：<br>hdfs://dn2:9000：hdfs分布式节点dn2为该HBase提供底层文件服务</p>
<ul>
<li>{名字空间}：在本文的示例中，因为在hbase shell建表做测试时，没有创建新的名字空间（相当于关系型数据库的database），所以hbase为company table提供默认default空间</li>
<li>{表名}:具体的HBase table名称，如本例的company table</li>
<li>{区域名称}：指HRegion的字符串名称：38445bbc84c64c82b8273edafbd19b07  由每张表切割形成，table创建开始阶段，仅有一个HRegion，当table越来越大，路径<code>hdfs://dn2:9000/hbase/data/&#123;名字空间&#125;/&#123;表名&#125;/</code>下将会有多个“区域名称”（也即分割为多个HRegion），这就是HRegion在hdfs的存在形式。</li>
<li>{列族名称}：例如本例创建的depart_info和staff_info 这两个列簇</li>
<li>{文件名}：这个文件就是Hfile，每个列簇下有自己存放key-value数据的最终物理文件，这里就是HBase存放数据的最小物理文件。</li>
</ul>
<p>以depart_info列簇查看它包含的文件有：bdccf10bf1a344baa68c4404b385da7b和dddb8e7e43134c16823db24416</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@nn ~]# hdfs dfs -ls /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/depart_info</span><br><span class="line">Found 2 items</span><br><span class="line">-rw-r--r--   3 root supergroup       5082 ** /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/depart_info/bdccf10bf1a344baa68c4404b385da7b</span><br><span class="line">-rw-r--r--   3 root supergroup       4859 ** /hbase/data/default/company/38445bbc84c64c82b8273edafbd19b07/depart_info/dddb8e7e43134c16823db24416</span><br></pre></td></tr></table></figure>
<p>&#8195;&#8195;继续查看depart_info路径下bdccf10bf1a344baa68c4404b385da7b文件内容，该文件为二进制文件，从内容可以大致看到该文件已经存储了R1和R2两行数据内容以及一些元信息等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">DATABLK*ˇˇˇˇˇˇˇˇ@&quot;&quot;R1depart_infoinner_telmÌµçS108R1depart_infolevelmÌµq19</span><br><span class="line">R1depart_infonamemÌµWOHR</span><br><span class="line">&quot;R2depart_infoinner_telmÌ∑£106R2depart_infolevelmÌ∑äF9R2depart_infonamemÌ∑n6Finance$©…]BLMFBLK2ˇˇˇˇˇˇˇˇ@%ÈíT@3+D4IDXROOT23&#x2F;ˇˇˇˇˇˇˇˇ@P&amp;&quot;R1depart_infoinner_telmÌµçS…“?IDXROOT2O@!ÁµãÏFILEINF2îêˇˇˇˇˇˇˇˇ@±PBUFä</span><br><span class="line"></span><br><span class="line">BLOOM_FILTER_TYPEROW</span><br><span class="line"></span><br><span class="line">DELETE_FAMILY_COUNT</span><br><span class="line"></span><br><span class="line">EARLIEST_PUT_TSmÌµWO</span><br><span class="line"></span><br><span class="line">KEY_VALUE_VERSION</span><br><span class="line"></span><br><span class="line">LAST_BLOOM_KEYR2</span><br><span class="line"></span><br><span class="line">MAJOR_COMPACTION_KEY</span><br><span class="line"></span><br><span class="line">MAX_MEMSTORE_TS_KEY</span><br><span class="line"></span><br><span class="line">MAX_SEQ_ID_KEY</span><br><span class="line"></span><br><span class="line">	TIMERANGEmÌµWOmÌ∑£</span><br><span class="line"></span><br><span class="line">hfile.AVG_KEY_LEN</span><br><span class="line"></span><br><span class="line">hfile.AVG_VALUE_LEN</span><br><span class="line"> </span><br><span class="line">hfile.CREATE_TIME_TSmÌÔ∂</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">hfile.LASTKEYR2depart_infonamemÌ∑n6˙x%ªBLMFMET2&lt;8ˇˇˇˇˇˇˇˇ@Y&amp;)R1Z8˚TRABLK&quot;$H»œ&#x2F; Ú&amp;(08@HPZ-org.apache.hadoop.hbase.KeyValue$KVComparator&#96;</span><br></pre></td></tr></table></figure>
<p>&#8195;&#8195;在namenode web页面：<a target="_blank" rel="noopener" href="http://dn2:50070/">http://dn2:50070/</a> 可以查看HFile相关信息，如下图所示，该HFile在HDFS集群上是3份拷贝的分布式存储。<br><img src="https://img-blog.csdnimg.cn/20191029225007131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3B5c2Vuc2U=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="6、HBase目录结构"><a href="#6、HBase目录结构" class="headerlink" title="6、HBase目录结构"></a>6、HBase目录结构</h3><p>&#8195;&#8195;HMaser在hdfs文件系统上创建了HBase目录，该目录用于存放所有关于HBase文件、数据、元信息等内容。</p>
<ul>
<li>/hbase/.tmp: 临时目录，当对表做创建和删除操作时，会将表move到该目录下，然后进行操作。</li>
<li> /hbase/WALs:在2.6章节已经提到，该目录为保存操作日志hlog，如下所示：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@nn ~]#  hdfs dfs -ls &#x2F;hbase&#x2F;WALs&#x2F;</span><br><span class="line">Found 3 items</span><br><span class="line">drwxr-xr-x   * &#x2F;hbase&#x2F;WALs&#x2F;dn1,16020,*</span><br><span class="line">drwxr-xr-x   * &#x2F;hbase&#x2F;WALs&#x2F;dn2,16020,*</span><br><span class="line">drwxr-xr-x   * &#x2F;hbase&#x2F;WALs&#x2F;nn,16020,*</span><br></pre></td></tr></table></figure>
从WALs目录下可以看到每个HRegionServer维护自己一个hlog</li>
<li>/hbase/data:核心目录，存储Hbase表的数据默认情况下该目录下有两个目录</li>
<li>/hbase/data/default:当在用户创建表的时候，没有指定namespace时，表就创建在此目录下<br>– /hbase/data/hbase：系统内部创建的表，hbase:meta，namespace</li>
<li>/hbase/hbase.id：存储集群唯一cluster id(UUID)</li>
<li> /hbase/hbase.version：集群版本号</li>
<li>/hbase/oldWALs：参考2.6章节内容——hlog过期</li>
</ul>
<h3 id="7、HBase的读写流程"><a href="#7、HBase的读写流程" class="headerlink" title="7、HBase的读写流程"></a>7、HBase的读写流程</h3><p>&#8195;&#8195;之所以把该章节安排在文章最后，是因为基于前面讨论HBase内部结构已经有一定了解后，再分析其读写流程则显得更容易理解。</p>
<h4 id="7-1-写流程"><a href="#7-1-写流程" class="headerlink" title="7.1 写流程"></a>7.1 写流程</h4><p>1）Client从Zookeeper中获取表region相关信息，根据要插入的rowkey，获取指定的Regionserver信息。<br>2）数据被写入Region的MemStore（操作也同时写入到Hlog中），若持续写入数据量超过MemStore达到预设阈值，MemStore会flush到StoreFile，当数据都同时写入到MemStore和Hlog后，那么对于client来说，本次写入即完成。<br>3）随着StoreFile文件的不断增多，当其数量增长到一定阈值后，触发Compact合并操作，将多个StoreFile合并成一个StoreFile。StoreFiles通过不断的Compact合并操作，逐步形成越来越大的StoreFile。<br>4）单个StoreFile大小超过一定阈值后，触发Split操作，把当前Region Split成2个新的Region。旧Region会下线，新Split出的2个Region会被HMaster分配到相应的RegionServer上，使得原先1个Region的压力得以分流到2个Region上。</p>
<h4 id="7-2-读流程"><a href="#7-2-读流程" class="headerlink" title="7.2 读流程"></a>7.2 读流程</h4><p>1）跟写流程一样，client先连接ZooKeeper，访问Meta Regionserver节点信息，把HBase的meta表缓存到client端。<br>2）根据rowkey找到Region，再去相应Regionserver 发起读请求。<br>3）RegionServer接收该读请求之后，既然是来询问key值是否存在，那么HBase针对检索，有自己一套方法：先查询MemStore，如果未找到，再去查询BlockCache加速读内容的缓冲区，如果还没有找到，就会到StoreFile（HFile）中查找这条数据，然后将这条数据返回给client。（注意：这里忽略了一个有关key高效检索是否存在与于HFIle的知识点：bloom-filter）<br>（从client在HBase读写请求过程可知，client其实无需与HMaster通信，只需要知道ZooKeeper地址即可）</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>本文已经完成对HBase架构及其数据模型较为全面的讨论，接下来在另外一篇文章开启对Hive的部署和架构分析，Hive跟HBase、Hadoop结合使用后，形成一套可用的数据仓库。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/HBase/" rel="tag"># HBase</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2019/10/28/%E5%9F%BA%E4%BA%8EHadoop%20HA%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2HBase%20HA%E9%9B%86%E7%BE%A4%EF%BC%88%E8%AF%A6%E7%BB%86%E7%89%88%EF%BC%89/" rel="prev" title="基于Hadoop HA集群部署HBase HA集群（详细版）">
      <i class="fa fa-chevron-left"></i> 基于Hadoop HA集群部署HBase HA集群（详细版）
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2019/11/06/supervisor%E7%AE%A1%E7%90%86web%E6%9C%8D%E5%8A%A1%E8%BF%9B%E7%A8%8B/" rel="next" title="supervisor管理web服务进程">
      supervisor管理web服务进程 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E6%9C%89%E5%85%B3HBase%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">1、有关HBase基本介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-HBase%E8%A7%A3%E5%86%B3%E7%9A%84%E7%97%9B%E7%82%B9%EF%BC%9A"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 HBase解决的痛点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-HBase%E5%BA%94%E7%94%A8%EF%BC%9A"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 HBase应用：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-Hbase%E7%89%B9%E6%80%A7%EF%BC%9A"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 Hbase特性：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81HBase%E6%9E%B6%E6%9E%84"><span class="nav-number">2.</span> <span class="nav-text">2、HBase架构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-HMaster"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 HMaster</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-HRegionServer"><span class="nav-number">2.2.</span> <span class="nav-text">2.1 HRegionServer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-HRegion"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 HRegion</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-Store"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 Store</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-MemStore%E3%80%81StoreFile%E3%80%81HFile"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 MemStore、StoreFile、HFile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-WALs%E2%80%94%E2%80%94Write-Ahead-Log%E9%A2%84%E5%86%99%E6%97%A5%E5%BF%97%EF%BC%88HLog%EF%BC%89"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 WALs——Write-Ahead-Log预写日志（HLog）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-zookeeper"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 zookeeper</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="nav-number">3.</span> <span class="nav-text">3、数据模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%E3%80%81%E8%A1%A8%E7%BB%93%E6%9E%84%E7%BB%84%E6%88%90%EF%BC%88%E5%AF%B9%E5%BA%94%E5%9B%BE3%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">4、表结构组成（对应图3）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5%E3%80%81HBase%E7%89%A9%E7%90%86%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">5.</span> <span class="nav-text">5、HBase物理文件存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-HRegion%E5%9C%A8%E8%A1%A8%E7%9A%84%E4%B8%8A%E4%BD%8D%E7%BD%AE"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 HRegion在表的上位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-HRegion%E8%87%AA%E5%8A%A8%E6%8B%86%E5%88%86"><span class="nav-number">5.2.</span> <span class="nav-text">4.2 HRegion自动拆分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-HRegion-%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8"><span class="nav-number">5.3.</span> <span class="nav-text">4.3 HRegion 分布式存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-Hbase%E6%95%B0%E6%8D%AE%E5%9C%A8HDFS%E7%9A%84%E5%AD%98%E5%82%A8"><span class="nav-number">5.4.</span> <span class="nav-text">5.2 Hbase数据在HDFS的存储</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6%E3%80%81HBase%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-number">6.</span> <span class="nav-text">6、HBase目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7%E3%80%81HBase%E7%9A%84%E8%AF%BB%E5%86%99%E6%B5%81%E7%A8%8B"><span class="nav-number">7.</span> <span class="nav-text">7、HBase的读写流程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-1-%E5%86%99%E6%B5%81%E7%A8%8B"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 写流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-%E8%AF%BB%E6%B5%81%E7%A8%8B"><span class="nav-number">7.2.</span> <span class="nav-text">7.2 读流程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">8.</span> <span class="nav-text">小结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt=""
      src="https://www.linuxprobe.com/wp-content/uploads/2018/06/QQ%E5%9B%BE%E7%89%8720180625205006.png">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">一个非常专注技术总结与分享的博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">48</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">48</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yield-bytes</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">575k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">8:43</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/pjax/pjax.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>

<script src="/blog/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/blog/js/local-search.js"></script>













    <div id="pjax">
  

  

  

    </div>
</body>
</html>
